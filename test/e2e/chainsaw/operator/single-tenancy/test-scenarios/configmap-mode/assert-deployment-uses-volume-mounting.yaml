apiVersion: apps/v1
kind: Deployment
metadata:
  name: yardstick
  namespace: toolhive-system
spec:
  template:
    spec:
      containers:
      - name: toolhive
        # Verify that individual config flags are NOT present when using ConfigMap
        (args | contains(@, '--transport=stdio')): false
        (args | contains(@, '--name=yardstick')): false
        # The image should still be present as a positional argument (required by proxy runner)
        (args | contains(@, 'ghcr.io/stackloklabs/yardstick/yardstick-server:0.0.2')): true
        # Verify runconfig volume mount is present
        volumeMounts:
        - name: runconfig
          mountPath: /etc/runconfig
          readOnly: true
      # Verify ConfigMap volume is configured
      volumes:
      - name: runconfig
        configMap:
          name: yardstick-runconfig