apiVersion: toolhive.stacklok.dev/v1alpha1
kind: EmbeddingServer
metadata:
  name: ($testPrefix)
  namespace: toolhive-system
spec:
  # Use a very lightweight model for testing (17.4M params)
  model: "sentence-transformers/paraphrase-MiniLM-L3-v2"
  image: "text-embeddings-inference"
  imagePullPolicy: IfNotPresent
  port: 8080
  replicas: 1
  # Enable model caching
  modelCache:
    enabled: true
    size: "5Gi"
    accessMode: "ReadWriteOnce"
  resources:
    limits:
      cpu: "500m"
      memory: "512Mi"
    requests:
      cpu: "250m"
      memory: "256Mi"
  env:
  - name: RUST_LOG
    value: "info"
