# HTTP PDP Authorization Configuration
#
# This example shows how to configure ToolHive to use an HTTP-based
# Policy Decision Point (PDP) for authorization. This is compatible
# with any PDP that implements the PORC-based decision endpoint.
#
# Start your PDP server (e.g., on port 9000), then start ToolHive with:
#   thv run --authz-config authz-httpv1-config.yaml ...
#
version: "1.0"
type: httpv1
pdp:
  http:
    url: "http://localhost:9000"
    timeout: 30                    # Request timeout in seconds (default: 30)
    insecure_skip_verify: false    # Skip TLS certificate verification (default: false)

  # Claim mapping controls how JWT claims are mapped to principal attributes (REQUIRED)
  # Options: "mpe", "standard"
  # - "mpe": Maps to MPE-specific m-prefixed claims (mroles, mgroups, mclearance, mannotations)
  # - "standard": Uses standard OIDC claim names (roles, groups)
  claim_mapping: "mpe"             # Required: Must specify claim mapper type

  # Context configuration controls what MCP-specific information is included
  # in the PORC context object. By default, no MCP context is included.
  context:
    include_args: false            # Include tool/prompt arguments in context.mcp.args
    include_operation: false       # Include feature, operation, resource_id in context.mcp
